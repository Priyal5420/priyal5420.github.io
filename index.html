<script>
function calc(){
 let level=document.getElementById("level").value;
 let msme=document.getElementById("msme")?.value || 
          document.querySelector('input[name="msme"]:checked')?.value;
 let cat=document.getElementById("cat").value;
 let milestone=document.getElementById("milestone")?.value || level;

 let HH=200000;
 let cert={
  Bronze:8000,
  Silver:32000,
  Gold:72000
 }[milestone];

 let hhRate={
  Micro:{Male:0.8,Women:0.9,SC:0.9},
  Small:{Male:0.6,Women:0.7,SC:0.7},
  Medium:{Male:0.5,Women:0.6,SC:0.6}
 };

 let certRate={
  Micro:{Male:0.8,Women:1.0,SC:0.9},
  Small:{Male:0.6,Women:1.0,SC:0.7},
  Medium:{Male:0.5,Women:1.0,SC:0.6}
 };

 let central = HH*hhRate[msme][cat] + cert*certRate[msme][cat];
 let balance = (HH+cert)-central;
 let state = (balance/1.18)*0.5;
 let final = balance - state;

 document.getElementById("actual").innerText=(HH+cert).toFixed(0);
 document.getElementById("central").innerText=central.toFixed(0);
 document.getElementById("bal").innerText=balance.toFixed(0);
 document.getElementById("state").innerText=state.toFixed(0);
 document.getElementById("final").innerText=final.toFixed(0);
}

function downloadPDF(){
 let client=document.getElementById("client").value || "Client";
 let level=document.getElementById("level").value;
 let msme=document.getElementById("msme")?.value || 
          document.querySelector('input[name="msme"]:checked')?.value;
 let cat=document.getElementById("cat").value;

 let cleanClient=client.replace(/[^a-zA-Z0-9]/g,"_");

 document.title=`ZED_${level}_${msme}_${cat}_${cleanClient}`;
 window.print();
}

calc();
</script>
